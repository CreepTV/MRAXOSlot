<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slot Browsergame</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="firebase.js"></script>
    
    <!-- Global Balance Manager -->
    <script src="balanceManager.js"></script>
    
    <!-- Einfache Version ohne Firebase f√ºr Test -->
    <script defer src="main.js"></script>
</head>
<body>
    <header>
        <!-- Guest Warning Notice -->
        <div class="guest-warning" id="guest-warning" style="display: none;">
            <div class="warning-content">
                <span class="warning-icon">‚ö†Ô∏è</span>
                <div class="warning-text">
                    <strong>Gastmodus</strong>
                    <span class="warning-subtext">Melde dich an f√ºr echten Fortschritt!</span>
                </div>
                <button class="warning-login-btn" id="warning-login-btn">
                    <span>üîë</span>
                    Anmelden
                </button>
            </div>
        </div>
        
        <div class="profile">
            <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Profil" id="profile-img" />
            <div class="profile-dropdown" id="profile-dropdown">
                <div class="dropdown-content">
                    <!-- F√ºr nicht eingeloggte Benutzer -->
                    <div class="guest-menu">
                        <div class="dropdown-item" id="login-btn">
                            <span class="dropdown-icon">üîë</span>
                            Anmelden
                        </div>
                        <div class="dropdown-item" id="register-btn">
                            <span class="dropdown-icon">üìù</span>
                            Registrieren
                        </div>
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-item guest-info">
                            <span class="dropdown-icon">üë§</span>
                            Gastmodus
                        </div>
                    </div>
                    
                    <!-- F√ºr eingeloggte Benutzer -->
                    <div class="user-menu" style="display: none;">
                        <div class="user-info">
                            <span class="username" id="username-display">Benutzer</span>
                            <span class="user-email" id="email-display">user@example.com</span>
                        </div>
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-item" id="public-profile-btn">
                            <span class="dropdown-icon">üëÅÔ∏è</span>
                            √ñffentliches Profil
                        </div>
                        <div class="dropdown-item" id="profile-settings">
                            <span class="dropdown-icon">‚öôÔ∏è</span>
                            Konto Settings
                        </div>
                        <div class="dropdown-item" id="stats-btn">
                            <span class="dropdown-icon">üìä</span>
                            Statistiken
                        </div>
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-item" id="logout-btn">
                            <span class="dropdown-icon">üö™</span>
                            Abmelden
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="header-balance"><span id="balance">1000</span></div>
    </header>
    <main>
        <section class="slot-cards">
            <div class="ad-card">
                <div class="slideshow">
                    <div class="slide active">Ad 1</div>
                    <div class="slide">Ad 2</div>
                    <div class="slide">Ad 3</div>
                </div>
                <div class="slideshow-dots">
                    <span class="dot active"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                </div>
            </div>
            <div class="slot-card emoji-bonanza">
                <div class="slot-card-header">
                    <div class="slot-title">Emoji Bonanza</div>
                    <div class="slot-subtitle">üé∞ Jackpot Slots</div>
                </div>
                <div class="slot-preview">
                    <div class="preview-reels">
                        <div class="preview-reel">
                            <span class="symbol">üçí</span>
                            <span class="symbol">üíé</span>
                            <span class="symbol">üçÄ</span>
                        </div>
                        <div class="preview-reel">
                            <span class="symbol">üîî</span>
                            <span class="symbol">‚≠ê</span>
                            <span class="symbol">üçâ</span>
                        </div>
                        <div class="preview-reel">
                            <span class="symbol">üçá</span>
                            <span class="symbol">üçä</span>
                            <span class="symbol">üçã</span>
                        </div>
                    </div>
                    <div class="jackpot-display">
                        <div class="jackpot-label">üí∞ JACKPOT</div>
                        <div class="jackpot-amount" id="jackpot-counter">‚Ç¨12,543</div>
                    </div>
                </div>
                <div class="slot-features">
                    <span class="feature-tag">üéØ Auto Spin</span>
                    <span class="feature-tag">üí´ Big Wins</span>
                    <span class="feature-tag">üéµ Music</span>
                </div>
                <div class="play-overlay">
                    <button class="play-btn" onclick="window.location.href='/EmojiBonanza'">
                        <span class="play-icon">‚ñ∂</span>
                        SPIELEN
                    </button>
                </div>
            </div>
            <div class="slot-card">Slot 2</div>
            <div class="slot-card">Slot 3</div>
        </section>
    </main>
    <nav class="bottom-nav">
        <button>Home</button>
        <button>Slots</button>
        <button>Shop</button>
        <button>Profil</button>
    </nav>
    <!-- Profil-Popup -->
    <div id="profile-modal" class="modal" style="display:none;">
        <div class="modal-content profile-modal-large">
            <span class="close" id="close-profile-modal">&times;</span>
            <div class="profile-modal-header">
                <div class="profile-img-container">
                    <img id="profile-modal-img" class="profile-modal-img" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Profilbild">
                    <input type="text" id="edit-imglink" class="edit-imglink-input" placeholder="Profilbild-URL" style="display: none;">
                </div>
                <div class="profile-modal-info">
                    <div class="profile-modal-row">
                        <div class="username-container">
                            <span id="profile-modal-username" class="profile-modal-username"></span>
                            <input type="text" id="edit-username" class="edit-username-input" maxlength="20" style="display: none;">
                        </div>
                        <button id="edit-profile-btn" class="edit-btn" title="Bearbeiten"><span>‚úèÔ∏è</span></button>
                        <button id="save-profile-btn" class="save-btn" title="Speichern" style="display: none;"><span>üíæ</span></button>
                        <button id="cancel-edit-btn" class="cancel-btn" title="Abbrechen" style="display: none;"><span>‚ùå</span></button>
                    </div>
                    <div class="profile-modal-row">
                        <div class="country-container">
                            <span id="profile-modal-country" class="profile-modal-country"></span>
                            <div class="custom-select-container" id="edit-country-container" style="display: none;">
                                <div id="custom-country-select" class="custom-select">
                                    <div class="select-selected">
                                        <img class="flag-icon" src="https://flagcdn.com/w40/de.png" alt="Germany">
                                        <span class="country-name">Deutschland</span>
                                        <span class="select-arrow">‚ñº</span>
                                    </div>
                                    <div class="select-items">
                                        <div class="select-item" data-value="Germany">
                                            <img class="flag-icon" src="https://flagcdn.com/w40/de.png" alt="Germany">
                                            <span>Deutschland</span>
                                        </div>
                                        <div class="select-item" data-value="Austria">
                                            <img class="flag-icon" src="https://flagcdn.com/w40/at.png" alt="Austria">
                                            <span>√ñsterreich</span>
                                        </div>
                                        <div class="select-item" data-value="Switzerland">
                                            <img class="flag-icon" src="https://flagcdn.com/w40/ch.png" alt="Switzerland">
                                            <span>Schweiz</span>
                                        </div>
                                        <div class="select-item" data-value="USA">
                                            <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="USA">
                                            <span>USA</span>
                                        </div>
                                        <div class="select-item" data-value="UK">
                                            <img class="flag-icon" src="https://flagcdn.com/w40/gb.png" alt="UK">
                                            <span>Vereinigtes K√∂nigreich</span>
                                        </div>
                                        <div class="select-item" data-value="France">
                                            <img class="flag-icon" src="https://flagcdn.com/w40/fr.png" alt="France">
                                            <span>Frankreich</span>
                                        </div>
                                        <!-- BEISPIEL: Manuell hinzugef√ºgtes Land (Notfall-Option) -->
                                        <div class="select-item" data-value="Italy">
                                            <img class="flag-icon" src="https://flagcdn.com/w40/it.png" alt="Italy">
                                            <span>Italien</span>
                                        </div>
                                        <!-- 
                                        ANLEITUNG: Um ein neues Land manuell hinzuzuf√ºgen, kopiere die Struktur oben:
                                        -->
                                        <div class="select-item" data-value="hss">
                                            <img class="flag-icon" src="https://yt3.googleusercontent.com/ytc/AIdro_mlcFbTClzGQOdfNyVuIATIcMMxqWhVrj-smBRQDqjpIQ=s900-c-k-c0x00ffffff-no-rj" alt="LAND_CODE">
                                            <span>HSS</span>
                                        </div>
                                        <!--
                                        Beispiele:
                                        - LAND_CODE: "Norway", FLAGGEN_CODE: "no", DEUTSCHER_NAME: "Norwegen"
                                        - LAND_CODE: "Sweden", FLAGGEN_CODE: "se", DEUTSCHER_NAME: "Schweden"
                                        - LAND_CODE: "Belgium", FLAGGEN_CODE: "be", DEUTSCHER_NAME: "Belgien"
                                        
                                        Flaggen-URL Format: https://flagcdn.com/w40/[L√ÑNDERCODE].png
                                        Liste der L√§ndercodes: https://flagcdn.com/
                                        -->
                                        <!-- Additional countries will be added dynamically -->
                                    </div>
                                </div>
                                <input type="hidden" id="edit-country" value="Germany">
                            </div>
                        </div>
                        <span id="profile-modal-level" class="profile-modal-level"></span>
                    </div>
                </div>
            </div>
            <div class="profile-modal-body">
                <label>Kommentar:</label>
                <div class="comment-container">
                    <div id="profile-modal-comment" class="profile-modal-comment"></div>
                    <textarea id="edit-comment" class="edit-comment-input" maxlength="100" placeholder="Schreibe etwas √ºber dich..." style="display: none;"></textarea>
                </div>
                <div class="profile-modal-row">
                    <div class="profile-stat">
                        <span class="profile-icon">üí∞</span>
                        <div class="profile-stat-value" id="profile-modal-balance">0</div>
                        <div class="profile-stat-label">Guthaben</div>
                    </div>
                    <div class="profile-stat">
                        <span class="profile-icon">üë•</span>
                        <div class="profile-stat-value" id="profile-modal-friends">0</div>
                        <div class="profile-stat-label">Freunde</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Ende Profil-Popup -->

    <!-- Account Settings Modal -->
    <div id="account-settings-modal" class="modal" style="display:none;">
        <div class="modal-content account-settings-modal">
            <div class="modal-header">
                <h2>
                    <span class="modal-icon">‚öôÔ∏è</span>
                    Konto Einstellungen
                </h2>
                <span class="close" id="close-account-settings-modal">&times;</span>
            </div>
            
            <div class="modal-body">
                <!-- E-Mail √Ñndern -->
                <div class="settings-section">
                    <div class="settings-section-header">
                        <span class="settings-icon">üìß</span>
                        <h3>E-Mail Adresse</h3>
                    </div>
                    <div class="settings-content">
                        <div class="current-value">
                            <label>Aktuelle E-Mail:</label>
                            <span id="current-email">user@example.com</span>
                        </div>
                        <div class="input-group">
                            <input type="email" id="new-email" placeholder="Neue E-Mail Adresse" class="settings-input">
                            <button id="change-email-btn" class="settings-btn">E-Mail √§ndern</button>
                        </div>
                    </div>
                </div>

                <!-- Passwort √Ñndern -->
                <div class="settings-section">
                    <div class="settings-section-header">
                        <span class="settings-icon">üîê</span>
                        <h3>Passwort</h3>
                    </div>
                    <div class="settings-content">
                        <div class="input-group">
                            <input type="password" id="current-password" placeholder="Aktuelles Passwort" class="settings-input">
                        </div>
                        <div class="input-group">
                            <input type="password" id="new-password" placeholder="Neues Passwort" class="settings-input">
                        </div>
                        <div class="input-group">
                            <input type="password" id="confirm-password" placeholder="Neues Passwort best√§tigen" class="settings-input">
                        </div>
                        <button id="change-password-btn" class="settings-btn">Passwort √§ndern</button>
                    </div>
                </div>

                <!-- Zwei-Faktor-Authentifizierung -->
                <div class="settings-section">
                    <div class="settings-section-header">
                        <span class="settings-icon">üõ°Ô∏è</span>
                        <h3>Zwei-Faktor-Authentifizierung</h3>
                    </div>
                    <div class="settings-content">
                        <div class="toggle-setting">
                            <div class="toggle-info">
                                <strong>2FA aktivieren</strong>
                                <p>Zus√§tzliche Sicherheit f√ºr dein Konto</p>
                            </div>
                            <div class="toggle-container">
                                <input type="checkbox" id="enable-2fa" class="toggle-checkbox">
                                <label for="enable-2fa" class="toggle-label">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                        <div id="qr-code-section" class="qr-section" style="display: none;">
                            <p>Scanne den QR-Code mit deiner Authenticator App:</p>
                            <div id="qr-code-display" class="qr-code-container">
                                <!-- QR Code wird hier generiert -->
                            </div>
                            <input type="text" id="verification-code" placeholder="Verifizierungscode eingeben" class="settings-input">
                            <button id="verify-2fa-btn" class="settings-btn">2FA best√§tigen</button>
                        </div>
                    </div>
                </div>

                <!-- Konto Sicherheit -->
                <div class="settings-section">
                    <div class="settings-section-header">
                        <span class="settings-icon">üîí</span>
                        <h3>Konto Sicherheit</h3>
                    </div>
                    <div class="settings-content">
                        <div class="security-info">
                            <div class="security-item">
                                <span class="security-label">Letzte Anmeldung:</span>
                                <span id="last-login">Heute, 14:30</span>
                            </div>
                            <div class="security-item">
                                <span class="security-label">Konto erstellt:</span>
                                <span id="account-created">15. Juni 2024</span>
                            </div>
                        </div>
                        <button id="logout-all-devices-btn" class="settings-btn danger-btn">Alle Ger√§te abmelden</button>
                    </div>
                </div>

                <!-- Konto l√∂schen -->
                <div class="settings-section danger-section">
                    <div class="settings-section-header">
                        <span class="settings-icon">‚ö†Ô∏è</span>
                        <h3>Gefahrenzone</h3>
                    </div>
                    <div class="settings-content">
                        <div class="danger-warning">
                            <p><strong>Achtung:</strong> Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.</p>
                        </div>
                        <button id="delete-account-btn" class="settings-btn danger-btn">Konto l√∂schen</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Ende Account Settings Modal -->

    <!-- Best√§tigungsdialog f√ºr Konto l√∂schen -->
    <div id="delete-account-confirm-modal" class="modal" style="display:none;">
        <div class="modal-content confirm-modal">
            <div class="modal-header">
                <h2>
                    <span class="modal-icon">‚ö†Ô∏è</span>
                    Konto l√∂schen best√§tigen
                </h2>
            </div>
            <div class="modal-body">
                <p><strong>Bist du sicher, dass du dein Konto l√∂schen m√∂chtest?</strong></p>
                <p>Diese Aktion ist <strong>unwiderruflich</strong>. Alle deine Daten werden dauerhaft gel√∂scht:</p>
                <ul>
                    <li>Dein Profil und alle Einstellungen</li>
                    <li>Dein Guthaben und Spielverlauf</li>
                    <li>Alle deine Freundschaften</li>
                    <li>Deine Statistiken und Erfolge</li>
                </ul>
                <div class="input-group">
                    <input type="password" id="delete-confirm-password" placeholder="Passwort zur Best√§tigung eingeben" class="settings-input">
                </div>
                <div class="confirm-buttons">
                    <button id="confirm-delete-btn" class="settings-btn danger-btn">Konto endg√ºltig l√∂schen</button>
                    <button id="cancel-delete-btn" class="settings-btn">Abbrechen</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Ende Best√§tigungsdialog -->
</body>
</html>
